# ========================================
# グローバル設定
# ========================================

[env]
_.file = [".env"]
_.path = ["./node_modules/.bin"]

# ========================================
# ツール
# ========================================

[tools]
node = "24.8.0"
"npm:pnpm" = "10.26.1"
taplo = "0.10.0"

# ========================================
# コマンド（実処理タスク）
# ========================================

[tasks.format]
description = "Biomeでソース全体を整形（自動修正あり）+ mise.tomlはTaploで整形"
run = ["pnpm run format", "taplo fmt mise.toml"]

[tasks."lint:types"]
description = "TypeScriptの型チェックのみ"
run = "pnpm exec tsc --noEmit"

[tasks."lint:biome"]
description = "Biomeのチェックのみ（自動修正なし）"
run = "pnpm run lint"

[tasks.test]
description = "Vitestでユニットテストを実行"
run = "pnpm run test"

[tasks."test:storybook"]
description = "Storybook(Vitest addon)でコンポーネントテストを実行"
run = "pnpm run test-storybook"
[tasks.build]
description = "TypeScriptをビルド"
run = "pnpm run build"

[tasks.clean]
description = "ビルド成果物を削除"
run = "pnpm run clean"

# ========================================
# エイリアス（まとめ実行）
# ========================================

[tasks.lint]
description = "型チェック + Biomeチェックを実行"
depends = ["lint:types", "lint:biome"]

[tasks.check]
description = "ローカル確認（lint + test + storybook）"
depends = ["lint", "test", "test:storybook"]

[tasks.ci]
description = "CI 相当のチェック (lint + build)"
depends = ["format", "lint", "test", "test:storybook", "build"]
run = "echo '✅ CI checks completed'"
